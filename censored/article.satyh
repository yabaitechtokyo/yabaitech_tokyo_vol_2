@import: bib
@import: ../main/book-class
@import: ../lib/code

let-inline ctx \todo inner =
  let ctx-todo =
    ctx |> set-text-color Color.red
  in
    read-inline ctx-todo {[TODO: #inner;]}

let censored-article = '<
  +chapter ?:(`censored-article`) (|
    bibliography = censored-bibliography;
    title = {ã‘ã‚‚ãƒ•ãƒ¬botã‚’æ”¯ãˆã‚‹æŠ€è¡“ï¼ˆæº–å‚™ç·¨ï¼‰};
    author = {censored};
    |) <
    +p {
      æœ¬è¨˜äº‹ã§ã¯ã€ï¼’ï¼ï¼‘ï¼—å¹´ï¼’æœˆï¼–æ—¥ã‚ˆã‚Šç¨¼åƒã—ã¦ã„ã‚‹â€ã‘ã‚‚ã®ãƒ•ãƒ¬ãƒ³ã‚ºãªã‚“ã ã­ï¼botâ€ï¼ˆ\@kemofre_botï¼‰ã®AWSã¸ã®ç§»è¡Œæ™‚ã®ä½œæ¥­éŒ²ã€ãŠã‚ˆã³botã®è§£èª¬ã‚’æ‰±ã£ã¦ã„ãã¾ã™ã€‚
      AWSã®ï¼‘å¹´é–“é™å®š\emph{ã§ã¯ãªã„}ç„¡æ–™æ ã‚’ä½¿ã£ã¦é‹ç”¨ã™ã‚‹ã“ã¨ã‚’ç›®æ¨™ã¨ã—ã¦ã„ãã¾ã™ã€‚
      æœ¬è¨˜äº‹ã®æ‰±ã†åˆ†é‡ã¨ã—ã¦ã¯AWS lambdaã€MeCabã€twitter botã®é‹ç”¨tipsã‚ãŸã‚Šã§ã™ãŒã€è§£èª¬ã¨ã„ã†ã‚ˆã‚Šã¯ãƒãƒ¼ãƒˆã«è¿‘ã„ã®ã§ã ã„ã¶åˆ†ã‹ã‚Šã¥ã‚‰ã„ã‹ã‚‚ã—ã‚Œã¾ã‚“ã€‚
      ã¾ãŸã€ç· ã‚åˆ‡ã‚Šã«è‰²ã€…é–“ã«åˆã‚ãªã‹ã£ãŸãŸã‚twitter botã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã®æº–å‚™ã¾ã§ã®è¨˜äº‹ã¨ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
      å› ã¿ã«ã€ã€ŒAWS lambda twitter botã€ã§Qxxtaã§æ¤œç´¢ã™ã‚‹ã¨63ä»¶ã»ã©ãƒ’ãƒƒãƒˆã™ã‚‹ã®ã§ã€æœ¬è¨˜äº‹ã§ä¸æ˜ç­ãªç‚¹ãŒã‚ã£ãŸã‚‰ãã®è¾ºã‚’å‚ç…§ã™ã‚Œã°å¤§ä¸ˆå¤«ã§ã™ï¼
    }
    +section {ãªãœä»Šæ›´ã‘ã‚‚ã®ãƒ•ãƒ¬ãƒ³ã‚ºbotãªã®ã‹} <
    +p {
      ç«¯çš„ã«è¨€ãˆã°ã€ï¼‘å¹´ã»ã©å‰ã¾ã§twitterã§ã‘ã‚‚ãƒ•ãƒ¬botã‚’é‹ç”¨ã—ã¦ã„ãŸã®ã§ã€æ‰‹å…ƒã«åŸºæœ¬çš„ãªã‚³ãƒ¼ãƒ‰ãŒã‚ã£ãŸã‹ã‚‰ã§ã™ã€‚
      ä½œæˆã—ãŸã®ãŒã‚‚ã†ï¼’å¹´å‰ã®ã“ã¨ã«ãªã‚‹ã®ã§æœ€æ—©å½“æ™‚ã®ã“ã¨ã¯æœ§ã’ã«ã—ã‹è¦šãˆã¦ã„ãªã„ã§ã™ãŒã–ã£ãã‚ŠçµŒç·¯ã‚’æ›¸ãã¨ã€ã‘ã‚‚ã®ãƒ•ãƒ¬ãƒ³ã‚ºbotã¯å†…è¼ªã§æ¥½ã—ã‚€ãŸã‚ã«ä½œã£ãŸtwitter botã§ã™ã€‚
      ç•Œéšˆã§æœ‰åãªäººã«é¢ç™½ãŒã‚‰ã‚Œã¦ä»¥é™ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼ãŒå¢—ãˆã€æœ€å¤§ã§ï¼‘ä¸‡ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼ç¨‹åº¦ã¾ã§è¡Œãã¾ã—ãŸã€‚å¾Œã€…ã„ã‚ã‚“ãªæ©Ÿèƒ½ã‚’ä»˜ã‘åŠ ãˆã¦ã„ãã¾ã—ãŸãŒã€botã®åŸºæœ¬çš„ãªã‚³ãƒ³ã‚»ãƒ—ãƒˆã¯å˜ç´”ã§ã™ã€‚
      ãƒ•ã‚©ãƒ­ãƒ¼ã®èª°ã‹ãŒ
      ã€Œä¸–ç•Œä¸€ãƒã‚°ã‚’ç”Ÿã‚€ã®ãŒå¾—æ„ã€
      ãªã©ã¨ç‰¹å®šã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆå¾—æ„ã€å¥½ãç­‰ï¼‰ã‚’å«ã‚€ãƒ„ã‚¤ãƒ¼ãƒˆã—ãŸã¨ãã«ã€ã™ã‹ã•ãš
      ã€Œã™ã£ã”ãƒ¼ã„ï¼ã‚ãªãŸã¯ä¸–ç•Œä¸€ãƒã‚°ã‚’ç”Ÿã‚€ã®ãŒå¾—æ„ãªãƒ•ãƒ¬ãƒ³ã‚ºãªã‚“ã ã­ï¼ã€
      ã¨è¿”ã™ã€å†…è¼ªã«ç…½ã‚Šãƒªãƒ—ãƒ©ã‚¤ã‚’é£›ã°ã™ãŸã‚ã®botã§ã—ãŸã€‚
      å¤§å­¦æ™‚ä»£ã¯å¤§å­¦ã«ç½®ãã£ã±ãªã—ã ã£ãŸå€‹äººç”¨PCã‚’ä½¿ã£ã¦é‹ç”¨ã—ã¦ã„ã¾ã—ãŸãŒã€å’æ¥­ã¨ã¨ã‚‚ã«é‹ç”¨ãŒçµ‚äº†ã—ã¾ã—ãŸã€‚
      ã“ã®ã¾ã¾ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚‚å‰Šé™¤ã—ã¦è‰¯ã‹ã£ãŸã®ã§ã™ãŒã€
      1) åœæ­¢ã—ãŸå¾Œã‚‚ã¡ã‚‡ãã¡ã‚‡ãå¾©æ´»ã•ã›ã¦ã»ã—ã„ã¨ãƒªãƒ—ãƒ©ã‚¤ã‚„DMãŒæ¥ã¦ã„ãŸ 2) AWSã®å‹‰å¼·ã‚’ã—ãŸã„ã¨æ€ã£ã¦ã„ãŸ 3)ï¼’æœŸã‚’ã‚„ã£ã¦ã„ãŸ ã®ï¼“ã¤ã®ç†ç”±ã‹ã‚‰ã“ã®botã‚’AWSä¸Šã«ç§»æ¤ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚
      è‰²ã€…ã€Œè©±é¡Œã€ã¨ãªã£ãŸï¼’æœŸã‚‚ãªã‚“ã¨ã‹ã“ã®è¨˜äº‹ã‚’æ›¸ããªãŒã‚‰è¦–è´ã—ã¦ã„ã¾ã™ã€‚ï¼‘ï¼‘è©±ã¾ã§è¦‹ã¾ã—ãŸãŒã€ï¼“è©±ã®ã‚¤ãƒ«ã‚«ã¨ï¼™è©±ã®ã‚¤ã‚¨ã‚¤ãƒŒãŒå¯æ„›ã„ã¨æ€ã„ã¾ã™ã€‚
      EC2ã¸ç§»ã™ã ã‘ãªã‚‰éå¸¸ã«ç°¡å˜ãªã®ã§ã™ãŒã€ã“ã‚“ãªbotã®ãŸã‚ã«ãŠé‡‘ã‚’æ‰•ã†ã®ã‚‚é¦¬é¹¿é¦¬é¹¿ã—ã„ã®ã§ã€AWSã®ç„¡æ–™æ ã«åã¾ã‚‹ã‚ˆã†ã«é ‘å¼µã£ã¦ã„ãã¾ã™ã€‚
    }
    >
    +section {AWS lambdaã«ã¤ã„ã¦} <
    +p {
      AWS lambdaã¨ã¯ã‚µãƒ¼ãƒãƒ¼ã®ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã‚„ç®¡ç†ã‚’ã™ã‚‹ã“ã¨ãªãã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚µãƒ¼ãƒ“ã‚¹\cite[`awslambdaofficial`];ã§ã™ã€‚
      ã„ã‚ã‚†ã‚‹ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é‹ç”¨ã™ã‚‹ãŸã‚ã®ã‚¯ãƒ©ã‚¦ãƒ‰ãƒªã‚½ãƒ¼ã‚¹ã§ã€å¸¸ã«å¤šãã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒæ¥ã‚‹ã“ã¨ãŒæœŸå¾…ã•ã‚Œãªã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®é‹ç”¨ã«å‘ã„ã¦ã„ã¾ã™ã€‚
      ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ä½•ã‹ã—ã‚‰ã®ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆä»Šå›ã¯cronã®æ§˜ãªä¸€å®šæ™‚é–“ï¼‰ã‚’ãƒˆãƒªã‚¬ãƒ¼ã¨ã—ã¦ä½•ã‹ã—ã‚‰ã®å‡¦ç†ï¼ˆä»Šå›ã¯twitterã®ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã®èª­ã¿å–ã‚Šã¨ãƒ„ã‚¤ãƒ¼ãƒˆå‡¦ç†ï¼‰ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
      AWS lambdaã«ã¯lambda functionã¨lambda layerã®2ç¨®é¡ãŒã‚ã‚Šã¾ã™ã€‚Lambda functionã¯å‡¦ç†ã‚’è¡Œã†ã‚³ãƒ¼ãƒ‰æœ¬ä½“ã€lambda layerã¯æ§˜ã€…ãªlambda functionã§ä½¿ç”¨ã§ãã‚‹zipã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã§ã™ã€‚
      Lambda functionã¯lambda layerã‚’ãƒãƒ¼ã‚¸ãƒ§ãƒ³åŒºåˆ‡ã‚Šã§èª­ã¿è¾¼ã‚€ã®ã§lambda layerã‚’æ›´æ–°ã—ãŸå ´åˆã€ãã‚Œã‚’ä½¿ç”¨ã™ã‚‹lambda functionã‚‚æ›´æ–°ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚
      ã‚ˆã£ã¦ã€lambda layerã§ã¯é »ç¹ã«é–‹ç™ºã‚’è¡Œã‚ãªã„ã‚³ãƒ¼ãƒ‰ã®å…±é€šéƒ¨åˆ†ã€lambda functionã§ã¯é »ç¹ã«é–‹ç™ºã‚’è¡Œã†ã‚³ãƒ¼ãƒ‰ã‚’ä½¿ã†ã‚ˆã†ã«æ›¸ãåˆ†ã‘ã‚‹ã“ã¨ã§åŠ¹ç‡ã‚ˆãé–‹ç™ºã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚
      ä»Šå›ã¯æ—¢å­˜ã®pythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚„MeCabãƒã‚¤ãƒŠãƒªã€MeCabè¾æ›¸ãªã©ã‚’layerã¨ã—ã¦æ‰±ã£ã¦ã„ã¾ã™ã€‚
      AWS lambdaã§ã¯æœˆã‚ãŸã‚Š1,000,000ä»¶ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€400 GB-ç§’ã®ãƒ¡ãƒ¢ãƒªä½¿ç”¨ã€3,200,000 ç§’ã®è¨ˆç®—æ™‚é–“ãŒ\emph{ç„¡æ–™}ã§åˆ©ç”¨ã§ãã¾ã™ã€‚
      ã“ã‚Œã‚‰ã®å†…ã©ã‚Œã‹ä¸€ã¤ã§ã‚‚è¶…éã™ã‚‹ã¨ãƒ¡ãƒ¢ãƒªã®ä½¿ç”¨é‡Ã—è¨ˆç®—æ™‚é–“ã«æ¯”ä¾‹ã—ãŸé‡‘é¡ãŒã‹ã‹ã‚Šã¾ã™ã€‚
    }
    >
    +section{ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—}<
    +subsection{AWSã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆAWS CLIï¼‰ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—} <
    +p {
      ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰ã§ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã‹ã‚‰ã¯10MBä»¥å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã—ã‹ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ããªã„ãŸã‚AWS CLIã‚’åˆ©ç”¨ã—ã¾ã™ã€‚
      å°šã€AWS CLIã§ã‚‚70MBä»¥å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã—ã‹ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ããªã„ã®ã§ã€MeCabã¯S3çµŒç”±ã§lambdaã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
      ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•ã¯å…¬å¼ã‚µã‚¤ãƒˆ\cite[`awscliofficial`];ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
      å€‹äººçš„ã«ã¯\code(`pip install awscli`);
      ã§ã‚ˆã„ã¨æ€ã„ã¾ã™ã€‚
    }
    >
    >
    +section{MeCab+ã‚«ã‚¹ã‚¿ãƒ NEologd IPAè¾æ›¸ã®lambda layerã®ä½œæˆ}<
    +subsection{Lambdaç”¨ã®MeCab ipadic-neologdã®ãƒ“ãƒ«ãƒ‰} <
    +subsubsection{äº‹å‰æº–å‚™} <
    +p {
      \cite[`qiita201809`];ã‚’å‚è€ƒã«è¡Œã„ã¾ã—ãŸã€‚
      https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/current-supported-versions.html
      ã«è¡Œã£ã¦ã€è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹AWS lambdaã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼ˆ2019å¹´3æœˆç¾åœ¨amzn-ami-hvm-2017.03.1.20170812-x86_64-gp2ï¼‰ã‚’èµ·å‹•ã—ã¾ã™ã€‚ä»¥ä¸‹ã€ãƒ­ã‚°ã‚¤ãƒ³å¾Œã®ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚
      \d-code(`
      # ç’°å¢ƒã‚’æœ€æ–°ã«ã—ã¦ãŠãã¾ã™ã€‚
      sudo yum update -y
      # MeCabã®ãƒ“ãƒ«ãƒ‰ã®ãŸã‚g++ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
      sudo yum install gcc-c++ -y
      # Neologdã®ãƒ“ãƒ«ãƒ‰ã®ãŸã‚patchã€gitã€autodieã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
      sudo yum install patch git perl-autodie.noarch -y
      # g++ã¸ã®ãƒ‘ã‚¹ã‚’é€šã—ã¾ã™ã€‚
      sudo ln -s /usr/libexec/gcc/x86_64-amazon-linux/4.8.5/cc1plus \
      /usr/local/bin/
      `);
      ã“ã‚Œã§æº–å‚™ã¯å®Œäº†ã§ã™ã€‚
    }
    >
    +subsubsection{MeCabã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨ãƒ“ãƒ«ãƒ‰}<
    +p {
      http://taku910.github.io/mecab ã¸è¡Œã£ã¦æœ€æ–°ã®ã‚‚ã®ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚
      \d-code(`
      cd ~
      curl -L \
"https://drive.google.com/uc"\
"?export=download&id=0B4y35FiV1wh7cENtOXlicTFaRUE" \
      -o mecab-0.996.tar.gz
      tar -zxvf mecab-0.996.tar.gz
      cd mecab-0.996
      # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…ˆã‚’/opt/ã«è¨­å®šã—ã¾ã™ã€‚
      sudo mkdir -p /opt
      sudo ./configure --prefix=/opt --with-charset=utf8
      sudo make
      sudo make install
      `);
    }
    >
    +subsubsection{IPAè¾æ›¸ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨ãƒ“ãƒ«ãƒ‰}<
    +p {
      \d-code(`
      cd ~
      curl -L \
"https://drive.google.com/uc"\
"?export=download&id=0B4y35FiV1wh7MWVlSDBCSXZMTXM" \
      -o mecab-ipadic-2.7.0-20070801.tar.gz
      tar -zxvf mecab-ipadic-2.7.0-20070801.tar.gz
      cd mecab-ipadic-2.7.0-20070801
      sudo ./configure --prefix=/opt --with-charset=utf8 \
      --with-mecab-config=/opt/bin/mecab-config
      sudo make
      sudo make install
      `);
    }
    >
    +subsubsection{mecab-python3ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨ãƒ“ãƒ«ãƒ‰} <
    +p {
      \d-code(`
      cd ~
      sudo yum install swig -y
      wget â€“quiet \
      https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh \
      -O ~/miniconda3.sh
      /bin/bash miniconda3.sh -b -p $HOME/miniconda3
      echo 'export PATH=$HOME/miniconda3/bin:$PATH' >> ~/.bashrc
      echo 'export PATH=$PATH:/opt/bin/' >> ~/.bashrc
      echo 'export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/opt/lib/' >> ~/.bashrc
      source ~/.bashrc
      sudo chown -R ec2-user /opt
      mkdir -p /opt/python/
      pip install mecab-python3 -t /opt/python/ 
      `);
    }
    >
    +subsubsection{NEologdè¾æ›¸ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨ãƒ“ãƒ«ãƒ‰} <
    +p {
      \d-code(`
      cd ~
      git clone --depth 1 https://github.com/neologd/mecab-ipadic-neologd.git
      cd mecab-ipadic-neologd/
      ./bin/install-mecab-ipadic-neologd -y \
      -p /opt/neologd-minimum -n â€“eliminate-redundant-enrty
      `);
      ã“ã®æ™‚ç‚¹ã§\code(`$HOME/neologd`);ã®ä¸­èº«ã¯400MBä»¥ä¸Šã‚ã‚Šã¾ã™ãŒã€åœ§ç¸®ã™ã‚‹ã¨90MBç¨‹åº¦ã«ãªã‚‹ã®ã§ã€S3çµŒç”±ã§lambda functionã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
      å‚è€ƒå…ƒã«ã—ãŸãŒã£ã¦ã€elimintate-redundant-entryã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã‚‹ã“ã¨ã«ã‚ˆã£ã¦æœ€å°æ§‹æˆã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è©¦ã¿ã¦ã„ã¾ã™ã€‚
      ã¡ãªã¿ã«ã€ä»–ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã¯t2.micro instanceã®ãƒ¡ãƒ¢ãƒªãŒè¶³ã‚Šãšã«ãƒ“ãƒ«ãƒ‰ãŒé€”ä¸­ã§è½ã¡ã¾ã™ã€‚
      ä»•æ–¹ãªã„ã®ã§ã€t2.medium instanceã‚’ãŠé‡‘ã‚’æ‰•ã£ã¦èµ·å‹•ã—ã¦--ignore-allã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã¿ã§ãƒ“ãƒ«ãƒ‰ã—ã¦ã¿ã¾ã—ãŸã€‚æ¯”è¼ƒã—ã¦ã¿ã‚‹ã¨ã€ã‚·ã‚¹ãƒ†ãƒ è¾æ›¸ã®éƒ¨åˆ†ãŒå¤§ããç•°ãªã£ã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚
      \d-code(`
      neologd-ignore-all:
      åˆè¨ˆ 702M
      -rw-r--r-- 1 ec2-user ec2-user 257K  2æœˆ  7 16:07 char.bin
      -rw-r--r-- 1 ec2-user ec2-user  693  2æœˆ  7 16:07 dicrc
      -rw-r--r-- 1 ec2-user ec2-user  73K  2æœˆ  7 16:07 left-id.def
      -rw-r--r-- 1 ec2-user ec2-user 3.4M  2æœˆ  7 16:07 matrix.bin
      -rw-r--r-- 1 ec2-user ec2-user 1.9K  2æœˆ  7 16:07 pos-id.def
      -rw-r--r-- 1 ec2-user ec2-user 7.3K  2æœˆ  7 16:07 rewrite.def
      -rw-r--r-- 1 ec2-user ec2-user  73K  2æœˆ  7 16:07 right-id.def
      -rw-r--r-- 1 ec2-user ec2-user 698M  2æœˆ  7 16:07 sys.dic
      -rw-r--r-- 1 ec2-user ec2-user 5.6K  2æœˆ  7 16:07 unk.dic

      neologd-minimum:
      åˆè¨ˆ 406M
      -rw-r--r-- 1 ec2-user ec2-user 257K  2æœˆ  7 16:21 char.bin
      -rw-r--r-- 1 ec2-user ec2-user  693  2æœˆ  7 16:21 dicrc
      -rw-r--r-- 1 ec2-user ec2-user  73K  2æœˆ  7 16:21 left-id.def
      -rw-r--r-- 1 ec2-user ec2-user 3.4M  2æœˆ  7 16:21 matrix.bin
      -rw-r--r-- 1 ec2-user ec2-user 1.9K  2æœˆ  7 16:21 pos-id.def
      -rw-r--r-- 1 ec2-user ec2-user 7.3K  2æœˆ  7 16:21 rewrite.def
      -rw-r--r-- 1 ec2-user ec2-user  73K  2æœˆ  7 16:21 right-id.def
      -rw-r--r-- 1 ec2-user ec2-user 403M  2æœˆ  7 16:21 sys.dic
      -rw-r--r-- 1 ec2-user ec2-user 5.6K  2æœˆ  7 16:21 unk.dic
      `);
      ã“ã®ä¸»ãªåŸå› ã¯seed/mecab-user-dict-seed.20190204.csv.xzãªã®ã§ã™ãŒã€ä¸­ã‚’è¦‹ã¦ã¿ã‚‹ã¨çµæ§‹ç¨‹é »åº¦ãã†ãªå˜èªã‚‚å¤šãåéŒ²ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚
      ã“ã“ã§ã€èªæ•°ã®é•·ã„å˜èªã¯ä½é »å‡ºã§ã‚ã‚‹ã¨ã„ã†çµŒé¨“çš„ãªä»®å®šã‚’ãŠãã¾ã™ã€‚
      /bin/install-mecab-ipadic-neologdã«â€”max_surface_lengthã¨min_surface_lengthã¨ã„ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒã‚ã‚‹ã®ã§ã€ã“ã‚Œã‚’ç”¨ã„ã¦é•·å˜èªã‚’è¾æ›¸ã‹ã‚‰å‰Šé™¤ã—ã¦ã„ãã¾ã™ã€‚
      ã—ã‹ã—ã€ã“ã®ã¾ã¾ã§ã¯IPAã®è¾æ›¸ã«ã‚‚ã“ã®é•·ã•åˆ¶é™ãŒã‹ã‹ã£ã¦ã—ã¾ã†ã®ã§ã€libexec/make-mecab-ipadic-neologd.shã‚’ä¿®æ­£ã—ã€mecab-user-dict-seed.20190204.csvã«ã®ã¿é¸æŠçš„ã«åå¿œã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚
      å·®åˆ†ã¨ã—ã¦ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
      \d-code(`
      diff --git a/libexec/make-mecab-ipadic-neologd.sh b/libexec/make-mecab-ipadic-neologd.sh
      index 5b7ae14..179efe9 100755
      --- a/libexec/make-mecab-ipadic-neologd.sh
      +++ b/libexec/make-mecab-ipadic-neologd.sh
      @@ -449,8 +449,10 @@ if [ ${MIN_SURFACE_LEN} -gt 0 -o ${MAX_SURFACE_LEN} -gt 0 ]; then
                    fi
                    if [ ${MAX_SURFACE_LEN} -gt 0 ]; then
      +               if [[ ${TMP_SEED_FILE_NAME} =~ mecab-user-dict-seed ]]; then
                    echo "${ECHO_PREFIX} Delete the entries whose length of surface
      is longer than ${MAX_SURFACE_LEN} from seed file"
                    cat ${NEOLOGD_DIC_DIR}/${TMP_SEED_FILE_NAME} | perl -ne "use 
      Encode;my \$l=\$_;my @a=split /,/,\$l;\$len=length Encode::decode_utf8(\$a[0]);
      print \$l if(\$len <= ${MAX_SURFACE_LEN});" >
      ${NEOLOGD_DIC_DIR}/${TMP_SEED_FILE_NAME}.tmp
                    mv ${NEOLOGD_DIC_DIR}/${TMP_SEED_FILE_NAME}.tmp 
      ${NEOLOGD_DIC_DIR}/${TMP_SEED_FILE_NAME}
      +             fi
                    fi
                  fi
              done
      `);
      ãã®å¾Œã€
      \d-code(`
      ./bin/install-mecab-ipadic-neologd -n -y \
      -p /opt/neologd-custom \
      --ignore_adverb \
      --ignore_interject \
      --ignore_noun_ortho \
      --ignore_noun_sahen_conn_ortho \
      --ignore_adjective_std \
      --ignore_adjective_verb \
      --ignore_ill_formed_words \
      --max_surface_length 11 \
      --min_surface_length 1
      `);
      ã‚’é©ç”¨ã—ãŸã¨ã“ã‚ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã¯501MBã«ãªã‚Šã¾ã—ãŸã€‚
      ã“ã®ï¼’ã¤ã®è¾æ›¸ã‚’æ¯”è¼ƒã—ã¦è¦‹ã¾ã™ã€‚ã‘ã‚‚ã®ãƒ•ãƒ¬ãƒ³ã‚ºã®å˜èªã¯ä»Šã§ã¯å¤šãã®å˜èªãŒç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ä½œæˆå½“æ™‚ã®ã‚ˆã†ãªã‚«ã‚¹ã‚¿ãƒ è¾æ›¸ã‚’è‡ªåˆ†ã§ä½œã‚‹æ‰‹é–“ã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ã™ã£ã”ãƒ¼ã„ï¼
      \d-code(`
      mecab -d neologd-minimum
      ã†ã¿ã‚ƒãƒ¼ï¼ã‚„ã£ã¦ã¿ãŸãƒ¼ã„ï¼
      ã†  æ„Ÿå‹•è©,*,*,*,*,*,ã†,ã‚¦,ã‚¦
      ã¿  æ¥é ­è©,åè©æ¥ç¶š,*,*,*,*,ã¿,ãƒŸ,ãƒŸ
      ã‚ƒ  åè©,ä¸€èˆ¬,*,*,*,*,*
      ãƒ¼  åè©,ä¸€èˆ¬,*,*,*,*,*
      ï¼  è¨˜å·,ä¸€èˆ¬,*,*,*,*,ï¼,ï¼,ï¼
      ã‚„  åŠ©è©,ä¸¦ç«‹åŠ©è©,*,*,*,*,ã‚„,ãƒ¤,ãƒ¤
      ã£ã¦  åŠ©è©,æ ¼åŠ©è©,é€£èª,*,*,*,ã£ã¦,ãƒƒãƒ†,ãƒƒãƒ†
      ã¿  æ¥é ­è©,åè©æ¥ç¶š,*,*,*,*,ã¿,ãƒŸ,ãƒŸ
      ãŸ  åŠ©å‹•è©,*,*,*,ç‰¹æ®Šãƒ»ã‚¿,åŸºæœ¬å½¢,ãŸ,ã‚¿,ã‚¿
      ãƒ¼  åè©,ä¸€èˆ¬,*,*,*,*,*
      ã„  åè©,ä¸€èˆ¬,*,*,*,*,ã„,ã‚¤,ã‚¤
      ï¼  è¨˜å·,ä¸€èˆ¬,*,*,*,*,ï¼,ï¼,ï¼
      EOS

      mecab -d neologd-custom
      ã†ã¿ã‚ƒãƒ¼ï¼ã‚„ã£ã¦ã¿ãŸãƒ¼ã„ï¼
      ã†ã¿ã‚ƒ  å‹•è©,è‡ªç«‹,*,*,äº”æ®µãƒ»ãƒè¡Œ,ä»®å®šç¸®ç´„ï¼‘,ã†ã‚€,ã‚¦ãƒŸãƒ£,ã‚¦ãƒŸãƒ£
      ãƒ¼  åè©,ä¸€èˆ¬,*,*,*,*,*
      ï¼  è¨˜å·,ä¸€èˆ¬,*,*,*,*,ï¼,ï¼,ï¼
      ã‚„ã£  å‹•è©,è‡ªç«‹,*,*,äº”æ®µãƒ»ãƒ©è¡Œ,é€£ç”¨ã‚¿æ¥ç¶š,ã‚„ã‚‹,ãƒ¤ãƒƒ,ãƒ¤ãƒƒ
      ã¦  åŠ©è©,æ¥ç¶šåŠ©è©,*,*,*,*,ã¦,ãƒ†,ãƒ†
      ã¿  å‹•è©,éè‡ªç«‹,*,*,ä¸€æ®µ,é€£ç”¨å½¢,ã¿ã‚‹,ãƒŸ,ãƒŸ
      ãŸ  åŠ©å‹•è©,*,*,*,ç‰¹æ®Šãƒ»ã‚¿,åŸºæœ¬å½¢,ãŸ,ã‚¿,ã‚¿
      ãƒ¼  åè©,ä¸€èˆ¬,*,*,*,*,*
      ã„  å‹•è©,è‡ªç«‹,*,*,ä¸€æ®µ,é€£ç”¨å½¢,ã„ã‚‹,ã‚¤,ã‚¤
      ï¼  è¨˜å·,ä¸€èˆ¬,*,*,*,*,ï¼,ï¼,ï¼
      EOS

      mecab -d neologd-minimum
      ã„ã„ã¨ã“ã¾ã§ãã¦ã‚‹ã§ã™ã­ã€ã‚„ã‚Šã¾ã™ã­
      ã„ã„  å½¢å®¹è©,è‡ªç«‹,*,*,å½¢å®¹è©ãƒ»ã‚¤ã‚¤,åŸºæœ¬å½¢,ã„ã„,ã‚¤ã‚¤,ã‚¤ã‚¤
      ã¨ã“  åè©,ä¸€èˆ¬,*,*,*,*,ã¨ã“,ãƒˆã‚³,ãƒˆã‚³
      ã¾ã§  åŠ©è©,å‰¯åŠ©è©,*,*,*,*,ã¾ã§,ãƒãƒ‡,ãƒãƒ‡
      ã  åŠ©å‹•è©,*,*,*,æ–‡èªãƒ»ã‚­,åŸºæœ¬å½¢,ã,ã‚­,ã‚­
      ã¦ã‚‹  åè©,å›ºæœ‰åè©,äººå,å,*,*,ã¦ã‚‹,ãƒ†ãƒ«,ãƒ†ãƒ«
      ã§ã™  åŠ©å‹•è©,*,*,*,ç‰¹æ®Šãƒ»ãƒ‡ã‚¹,åŸºæœ¬å½¢,ã§ã™,ãƒ‡ã‚¹,ãƒ‡ã‚¹
      ã­  åŠ©è©,çµ‚åŠ©è©,*,*,*,*,ã­,ãƒ,ãƒ
      ã€  è¨˜å·,èª­ç‚¹,*,*,*,*,ã€,ã€,ã€
      ã‚„  åŠ©è©,ä¸¦ç«‹åŠ©è©,*,*,*,*,ã‚„,ãƒ¤,ãƒ¤
      ã‚Š  åŠ©å‹•è©,*,*,*,æ–‡èªãƒ»ãƒª,åŸºæœ¬å½¢,ã‚Š,ãƒª,ãƒª
      ã¾ã™  åŠ©å‹•è©,*,*,*,ç‰¹æ®Šãƒ»ãƒã‚¹,åŸºæœ¬å½¢,ã¾ã™,ãƒã‚¹,ãƒã‚¹
      ã­  åŠ©è©,çµ‚åŠ©è©,*,*,*,*,ã­,ãƒ,ãƒ
      EOS

      mecab -d neologd-custom
      ã„ã„ã¨ã“ã¾ã§ãã¦ã‚‹ã§ã™ã­ã€ã‚„ã‚Šã¾ã™ã­
      ã„ã„  å½¢å®¹è©,è‡ªç«‹,*,*,å½¢å®¹è©ãƒ»ã‚¤ã‚¤,åŸºæœ¬å½¢,ã„ã„,ã‚¤ã‚¤,ã‚¤ã‚¤
      ã¨ã“  åè©,ä¸€èˆ¬,*,*,*,*,ã¨ã“,ãƒˆã‚³,ãƒˆã‚³
      ã¾ã§  åŠ©è©,å‰¯åŠ©è©,*,*,*,*,ã¾ã§,ãƒãƒ‡,ãƒãƒ‡
      ã  å‹•è©,è‡ªç«‹,*,*,ã‚«å¤‰ãƒ»ã‚¯ãƒ«,é€£ç”¨å½¢,ãã‚‹,ã‚­,ã‚­
      ã¦ã‚‹  å‹•è©,éè‡ªç«‹,*,*,ä¸€æ®µ,åŸºæœ¬å½¢,ã¦ã‚‹,ãƒ†ãƒ«,ãƒ†ãƒ«
      ã§ã™  åŠ©å‹•è©,*,*,*,ç‰¹æ®Šãƒ»ãƒ‡ã‚¹,åŸºæœ¬å½¢,ã§ã™,ãƒ‡ã‚¹,ãƒ‡ã‚¹
      ã­  åŠ©è©,çµ‚åŠ©è©,*,*,*,*,ã­,ãƒ,ãƒ
      ã€  è¨˜å·,èª­ç‚¹,*,*,*,*,ã€,ã€,ã€
      ã‚„ã‚Š  å‹•è©,è‡ªç«‹,*,*,äº”æ®µãƒ»ãƒ©è¡Œ,é€£ç”¨å½¢,ã‚„ã‚‹,ãƒ¤ãƒª,ãƒ¤ãƒª
      ã¾ã™  åŠ©å‹•è©,*,*,*,ç‰¹æ®Šãƒ»ãƒã‚¹,åŸºæœ¬å½¢,ã¾ã™,ãƒã‚¹,ãƒã‚¹
      ã­  åŠ©è©,çµ‚åŠ©è©,*,*,*,*,ã­,ãƒ,ãƒ
      EOS
      `);
      --eliminate-redundant-enrtyãŒMeCabã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯éæ¨å¥¨ã§ã‚ã£ãŸé€šã‚Šã€ã‚„ã¯ã‚Šæ€§èƒ½ãŒã ã„ã¶é•ã£ã¦ã„ã¾ã™ã€‚
      --eliminate-redundant-entryã¯è¾æ›¸ã®å˜èªã«éå¯é€†ãªæ­£è¦åŒ–ã‚’æ–½ã—ãƒ“ãƒ«ãƒ‰ã™ã‚‹ãŸã‚ã€å®Ÿéš›ã®å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚‚æ­£è¦åŒ–ã‚’æ–½ã—ãŸå¾Œã«mecabã«å…¥åŠ›ã™ã‚‹ã‚ˆã†ãªã‚±ãƒ¼ã‚¹ã€
      ã™ãªã‚ã¡æ¤œç´¢ã‚„æ¨è–¦ãªã©å˜èªã®æ­£è¦å½¢ã®ã¿å¾—ã‚‰ã‚Œã‚Œã°ååˆ†ãªå ´åˆã§ã¯æœ‰åŠ¹ã§ã™ãŒã€ä»Šå›ã®ã‚ˆã†ãªé¸šéµ¡è¿”ã—ã‚’æƒ³å®šã—ãŸçŠ¶æ³ã§ã¯ä½¿ç”¨ã™ã‚‹ã®ã¯é›£ã—ã„ã“ã¨ãŒæ”¹ã‚ã¦ç¢ºèªã•ã‚Œã¾ã—ãŸã€‚
      ã“ã“ã¾ã§ã«t2.micro t2.mediumã‚’èµ·å‹•ã—ãŸã®ã§\$0.06ã‹ã‹Ä±ã‚Šã¾ã—ãŸãƒ»ãƒ»ãƒ»ã€‚MeCabè¾æ›¸ã®ãƒ“ãƒ«ãƒ‰ã‚‚ç„¡æ–™ã§ã§ãã‚‹æ–¹æ³•ãŒã‚ã£ãŸã‚‰ã©ãªãŸã‹æ•™ãˆã¦ä¸‹ã•ã„ã€‚
      ã“ã“ã¾ã§ã§MeCabã‚’lambdaã§å‹•ã‹ã™ã®ã«å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã¯æƒã£ãŸã®ã§ã€/optä»¥ä¸‹ã®/opt/awsä»¥å¤–ã‚’scpãªã‚Šä½•ãªã‚Šã§ãƒ­ãƒ¼ã‚«ãƒ«ã«è½ã¨ã—ã¦ãŠãã¾ã™ã€‚
      å°šã€/opt/lib/mecabä»¥ä¸‹ã«ã‚ã‚‹ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®IPAè¾æ›¸ã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“ã€‚
    }
    >
    +subsubsection{Lambda layerã¨ã—ã¦å›ºã‚ã‚‹} <
    +p {
      å…ˆã»ã©ä½œæˆã—ãŸã‚«ã‚¹ã‚¿ãƒ IPA-NEologdè¾æ›¸ã¯neologd-minimumã§ã‚ã‚Œã€neologd-customã§ã‚ã‚Œzipãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦åœ§ç¸®ã—ãªã„ã¨lambdaã§å‹•ã‹ã™ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚
      ãã®ãŸã‚ã€ã¾ãšã¯è¾æ›¸ã‚’zipã§å›ºã‚ã¾ã™ã€‚
      ãã—ã¦ã€ãã®zipãƒ•ã‚¡ã‚¤ãƒ«ã‚’å±•é–‹ã™ã‚‹ãŸã‚ã®pythonãƒ•ã‚¡ã‚¤ãƒ«\code(`python/unzip_neologd.py`);ã‚’è¨˜è¿°ã—ã¾ã™ã€‚
      \d-code(`
      from zipfile import ZipFile
      import os
      import traceback
      import re

      def unzip_neologd():
        with ZipFile('/opt/neologd.zip', 'r') as zipObj:
           # Extract all the contents of zip file in different directory
           zipObj.extractall('/tmp/')
        return "/tmp/neologd"
      `);
      ãã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã«è½ã¨ã—ãŸå¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…¨ã¦å›ºã‚ãŸzipãƒ•ã‚¡ã‚¤ãƒ«ã‚’S3ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰ã‚½ãƒ¼ã‚¹å…ƒã¨ã—ã¦æŒ‡å®šã—ã¾ã™ã€‚
      å®Ÿéš›ã«å‹•ã‹ã™éš›ã«ã¯
      \d-code(`
      import MeCab
      from unzip_neologd import unzip_neologd
      neologd_path = unzip_neologd()
      tagger = MeCab.Tagger(" -d " + neologd_path)
      print(tagger.parse("ã‘ã‚‚ãƒ•ãƒ¬ï¼’æœŸã€ï¼‘æœŸã«æ¯”ã¹ã‚‹ã¨ã‚ã‚“ã¾ã‚Šå„ªã—ããªã„ä¸–ç•Œã«ãªã£ã¦ã—ã¾ã£ãŸæ°—ãŒã—ã¾ã™ã€‚"))
      `);
      ã®æ§˜ã«ã™ã‚‹ã“ã¨ã§ã‚«ã‚¹ã‚¿ãƒ è¾æ›¸ã§MeCabã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
    }
    >
    >
    >
    +section{Twitter botã‚’å‹•ã‹ã™} <
    +p {
      ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯å®Ÿéš›ã«lambdaã‚’ç”¨ã„ã¦twitter botã‚’å‹•ã‹ã—ã¦ã„ãã¾ã™ã€‚
      æ­£ç›´ãªã¨ã“ã‚ä»Šå›ã®botã§æŠ€è¡“çš„ã«ä¸€ç•ªé›£ã—ã„ã®ã¯å‰ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®MeCabã®å‹•ã‹ã—æ–¹ãªã®ã§ã€ã“ã‚Œä»¥é™ã¯ç´°ã‹ã„æŠ€è¡“çš„ãªå·¥å¤«ã‚„twitterç¤¾ã«å‡çµã•ã‚Œãªã„é‹ç”¨ã®ä»•æ–¹ã®è©±ã‚’ã—ã¦ã„ãã¾ã™ã€‚
    }
    +subsection{æº–å‚™} <
    +subsubsection{Twitter APIç”¨ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã®å–å¾—}<
    +p{
      Twitter APIã‚’å‘¼ã¶ã®ã«å¿…è¦ãªã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã‚’Twitter Developer Platformï¼ˆhttps://developer.twitter.com/ï¼‰ã§ç”³ã—è¾¼ã¿ã¾ã™ã€‚
      ç¾åœ¨ã§ã¯å¯©æŸ»ãŒã ã„ã¶å³ã—ããªã£ã¦ã—ã¾ã£ã¦ã„ã¾ã™ãŒã€å½“æ™‚ã¯ã‚‚ã†å°‘ã—æ¥½ã ã£ãŸã®ã§é–‹ç™ºç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨é‹å–¶ç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãã‚Œãã‚Œã§ã‚­ãƒ¼ã‚’å–å¾—ã—ã¦ã„ã¾ã™ã€‚
    }
    >
    +subsubsection{Tweepyã®lambda layerã®ä½œæˆ}<
    +p{
      Twitter botã‚’å‹•ã‹ã™ã®ã«ä»Šå›ã¯tweepyã‚’ç”¨ã„ã¾ã™ã€‚MeCabã®ãƒ“ãƒ«ãƒ‰æ™‚ã«ç”¨ã„ãŸç’°å¢ƒï¼ˆä»Šå›ã¯t2.microã§ã‚‚å¤§ä¸ˆå¤«ã§ã™ï¼‰ã‚’ç”¨ã„ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
      ä»Šå›ã¯MeCabã¨åˆ¥ã®lambda layerã¨ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã„ã®ã§ã€åˆ¥ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
      \d-code(`
      sudo rm -r /opt/python
      pip install tweepy -t /opt/python/
      `);
      /opt/pythonã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€zipã§å›ºã‚ã¦lambda layerã‚’ä½œæˆã—ã¾ã™ã€‚ä»Šåº¦ã¯CLIã§ã‚‚ä½œæˆã§ãã‚‹ã¯ãšã§ã™ã€‚
      \d-code(`
      aws lambda publish-layer-version --layer-name tweepy \
      --description "tweepy python library" \
      --zip-file fileb://<path to file>/tweepy_layer.zip \
      --compatible-runtimes python3.7
      `);
    }
    >
    >
    +subsection{åŸºæœ¬å‹•ä½œã®å®Ÿè£…}<
    +p {
      ã•ã¦ã€ã“ã†ã—ã¦lambdaä¸Šã§twitter botã‚’å‹•ã‹ã™æº–å‚™ã¯ã§ãã¾ã—ãŸã€‚
      ã‘ã‚‚ãƒ•ãƒ¬botã®æ©Ÿèƒ½ã®å†…ã€æœ€ã‚‚å˜ç´”ãªæ©Ÿèƒ½ã§ã‚ã‚‹ã€Œä¸€å®šæ™‚é–“æ¯ã«ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«ãƒ„ã‚¤ãƒ¼ãƒˆã‚’å–å¾—ã—ã€å¯¾å¿œã™ã‚‹ãƒ„ã‚¤ãƒ¼ãƒˆã‚’ã™ã‚‹ã€ã®éƒ¨åˆ†ã®å®Ÿè£…ã«å…¥ã‚Šã¾ã™ã€‚
      ãŒã€ãã®å‰ã«ã„ãã¤ã‹æ°—ã‚’ã¤ã‘ã¦ãŠãéƒ¨åˆ†ãŒã‚ã‚‹ã®ã§è¨˜ã—ã¦ãŠãã¾ã™ã€‚
    }
    +subsubsection{Pythonã§ã®æ—¥æœ¬èªå‡¦ç†} <
    +p {
      lambdaã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã ã¨æ—¥æœ¬èªï¼ˆå¤šåˆ†ãƒãƒ«ãƒãƒã‚¤ãƒˆæ–‡å­—ï¼‰ã«å¯¾å¿œã—ã¦ã„ãªã„ã®ã§
      \code(`# -*- coding: utf-8 -*-`);ã‚’lambda functionã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«åŠ ãˆã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚
    }
    >
    +subsubsection{mecab-python3ã®å‡¦ç†é€Ÿåº¦} <
    +p {
      \cite[`qiita2015`];ã«ã‚ˆã‚Œã°ã€mecab-python3ã®parseToNodeãƒ¡ã‚½ãƒƒãƒ‰ã¯parseãƒ¡ã‚½ãƒƒãƒ‰ã«æ¯”ã¹ï¼’å€ä»¥ä¸Šé…ã„ã‚ˆã†ã§ã™ã€‚
      ï¼”å¹´å‰ã®è¨˜äº‹ã ã£ãŸã®ã§ä¸€å¿œæ‰‹å…ƒã§è¿½è©¦é¨“ã‚’è¡Œã£ãŸã¨ã“ã‚ã€ç¢ºã‹ã«2å€ç¨‹åº¦ã®å·®ãŒã‚ã£ãŸã®ã§ç¢ºã‹ãªã‚ˆã†ã§ã™ã€‚
      æ©Ÿèƒ½ã‚’ãƒ•ãƒ«ã«ä½¿ãŠã†ã¨ã—ãªã„é™ã‚Šã€è‡ªä½œã§parseToNodeã‚’å®Ÿè£…ã—ãŸæ–¹ãŒè‰¯ã•ãã†ã§ã™ã€‚
    }
    >
    +subsubsection{ç©ºç™½ã®å‡¦ç†} <
    +p {
      ç©ºç™½ã®å«ã¾ã‚ŒãŸæ–‡å­—åˆ—ã‚’MeCabã«å…¥åŠ›ã™ã‚‹ã¨ã€é€šå¸¸ç©ºç™½ã¯å‡ºåŠ›çµæœã«ã¯å«ã¾ã‚Œã¾ã›ã‚“ã€‚
      ã—ã‹ã—ã“ã®è¨­å®šã§ã¯ã€ä¾‹ãˆã°ã€Œã‚µãƒ¼ãƒãƒ«ã€€ã‚¿ãƒ™ãƒãƒ£ãƒ€ãƒ¡ãƒ€ãƒ¨ã€ã¨ã„ã†åŠè§’ç©ºç™½æ–‡å­—åˆ—ã‚’MeCabã«å…¥åŠ›ã™ã‚‹ã¨tokenizationã®åˆ¤æ–­ã«ã¯ç”¨ã„ã‚‰ã‚Œã¾ã™ãŒå‡ºåŠ›ã«ã¯ç¾ã‚Œãšã€å…ƒã®æ–‡å­—åˆ—ã‚’å¾©å…ƒã™ã‚‹ã“ã¨ãŒå›°é›£ã§ã™ã€‚
      ãã“ã§ã€\cite[`mecabspace2012`];ã§ç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’MeCabã®Taggerã«ä¸ãˆã¾ã™ã€‚
      \d-code(`
      r' --node-format=%M\t%f[0],%f[1],%f[2],%f[3],%f[4],%f[5],%f[6],%f[7],%f[8]\n'
      r' --unk-format=%M\t%f[0],%f[1],%f[2],%f[3],%f[4],%f[5],%f[6]\n '
      `);
      ã“ã‚Œã«ã‚ˆã‚Šæ–‡ä¸­ã®åŠè§’ã‚¹ãƒšãƒ¼ã‚¹ãŒæ¬¡ã®å˜èªã¨çµåˆã—ã¦è¦‹å‡ºã—èªã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
    }
    >
    +subsubsection{ç„¡æ–™æ å†…ã§ã®è¨±å®¹è¨ˆç®—æ™‚é–“} <
    +p {
      ã•ã¦ã€Lambdaã®ç„¡æ–™æ å†…ã§botã§å‹•ã‹ã™ã“ã¨ã¯å®Ÿéš›ã«å¯èƒ½ã‹ã‚’è€ƒãˆã¦ã¿ã¾ã™ã€‚
      MeCabã‚’lambdaã§å®Ÿéš›ã«å‹•ã‹ã™ã®ã«å¿…è¦ãªãƒ¡ãƒ¢ãƒªã¯1024MBã‚ã‚Œã°å¤§ä¸ˆå¤«ãã†ã§ã™ã€‚
      Lambdaã¯æœˆé–“400,000GBç§’ãªã®ã§ã€400,000 \* 1024 / 1024 / 31 / 24 / 60 = 8.96å›/åˆ†ã®ãƒšãƒ¼ã‚¹ã§functionã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚
      3,200,000ç§’ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ™‚é–“ãŒç„¡æ–™ãªã®ã§ã€3,200,000 / 31 / 24 / 60 = 71.68ç§’/åˆ†functionã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚
      ã‘ã‚‚ãƒ•ãƒ¬botã‚’ä¸€å›ç¨¼åƒã•ã›ã‚‹ã®ã«ã‹ã‹ã‚‹æ™‚é–“ã¯20ç§’ä»¥å†…ãªã®ã§20ç§’ãŠãç¨‹åº¦ã«å‘¼ã³å‡ºã™ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚    
    }
    >
    >
    >
    +section{å°å…¥ç·¨ã¾ã¨ã‚} <
    +p {
      å®Ÿã¯3æœˆä¸­æ—¬é ƒã«botã®æœ€å°é™ã®æ©Ÿèƒ½ã‚’å†é–‹ã—ã¦ã„ã¾ã™ã€‚ãŸã ã€ä»–ã®æ©Ÿèƒ½ã¯å‡çµå›é¿ã®ç‚ºã«æ§˜ã€…ãªå·¥å¤«ã‚’æ–½ã™å¿…è¦ãŒã‚ã‚‹ç‚ºç°¡å˜ã«ã¯å®Ÿè£…ã§ãã¦ã„ã¾ã›ã‚“ã€‚
      å°šã€Google Cloud Platformã§ã¯f1.microã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒï¼‘ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å¹´åˆ†ç„¡æ–™ãªã®ã§ã€GCPã‚’ä½¿ãˆã°ã“ã‚“ãªé¢å€’ãªã“ã¨ã¯ã›ãšã«ç°¡å˜ã«ã§ãã¾ã™ã€‚GCPä½¿ã„ã¾ã—ã‚‡ã†ã€‚
    }
    >
  >
>